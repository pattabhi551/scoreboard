<!--<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-material/paper-material.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../paper-button/paper-button.html">-->

<!--
An element providing a solution to no problem in particular.
Example:
    <tpa-component></tpa-component>
Example:
    <tpa-component>
      <h2>Hello tpa-component</h2>
    </tpa-component>
@demo demo/index.html
-->
<dom-module id="input-score">
  <template>
    <style is="custom-style" include="iron-flex iron-flex-alignment iron-flex-factors">
      paper-button {
        background-color: var(--paper-blue-900);
        color: white;
        margin: 10px;
      }
    </style>

    <firebase-app auth-domain="scoreboard-a046c.firebaseapp.com"
                  name="scoreboard"
                  database-url="https://scoreboard-a046c.firebaseio.com"
                  api-key="AIzaSyDiwFRGWF7RIi6irEy6HKdIpPoOWTz6Izo">
    </firebase-app>
    <firebase-auth id="auth" app-name="scoreboard">
    </firebase-auth>
    <firebase-document id="fireQuery"
                       path="/team/fixtures/0/score"
                       app-name="scoreboard"
                       data="{{score}}">
    </firebase-document>

    <div class="layout horizontal flex wrap">
      <paper-input class="flex-3" type="number" value="{{score.runs}}" label="runs" maxlength="5"></paper-input>
      <paper-input class="flex-3" type="number" value="{{score.overs}}" min="0" max="60" label="overs"
                   maxlength="3"></paper-input>
      <paper-input class="flex-3" type="number" value="{{score.balls}}" min="0" max="6" label="balls"
                   maxlength="2"></paper-input>
      <paper-input class="flex-3" type="number" value="{{score.wickets}}" min="0" max="10" label="wickets"
                   maxlength="2"></paper-input>
      <paper-input class="flex-3" type="number" value="{{score.target}}" min="0" max="2000" label="Target"
                   maxlength="10"></paper-input>
    </div>

    <div class="layout horizontal flex wrap">
      <paper-button class="flex-2" raised on-tap="incrementBalls">Dot</paper-button>
      <paper-button class="flex-2" raised on-tap="incrementScore" runs="1">1</paper-button>
      <paper-button class="flex-2" raised on-tap="incrementScore" runs="2">2</paper-button>
      <paper-button class="flex-2" raised on-tap="incrementScore" runs="3">3</paper-button>
      <paper-button class="flex-2" raised on-tap="incrementScore" runs="4">4</paper-button>
      <paper-button class="flex-2" raised on-tap="incrementScore" runs="6">6</paper-button>
      <!--<paper-button class="flex-2" raised disabled>OTHER</paper-button>-->
    </div>
    <div class="layout horizontal flex wrap">
      <paper-button class="flex-2" on-tap="incrementBalls" raised>Dropped Catch</paper-button>
      <paper-button class="flex-2" on-tap="incrementScore" runs="1" raised>1 Bye</paper-button>
      <paper-button class="flex-2" on-tap="incrementScore" runs="2" raised>2 Byes</paper-button>
      <paper-button class="flex-2" on-tap="incrementScore" runs="3" raised>3 Byes</paper-button>
      <paper-button class="flex-2" on-tap="incrementScore" runs="4" raised>4 Byes</paper-button>
      <!--<paper-button class="flex-2" raised>OTHER</paper-button>-->
    </div>
    <div class="layout horizontal flex wrap">
      <!--<paper-button class="flex-2" raised>Add note</paper-button>-->
      <paper-button class="flex-2" on-tap="incrementScore" runs="1" raised>1 LB</paper-button>
      <paper-button class="flex-2" on-tap="incrementScore" runs="2" raised>2 LBs</paper-button>
      <paper-button class="flex-2" on-tap="incrementScore" runs="3" raised>3 LBs</paper-button>
      <paper-button class="flex-2" on-tap="incrementScore" runs="4" raised>4 LBs</paper-button>
      <!--<paper-button class="flex-2" raised>OTHER</paper-button>-->
    </div>
    <div class="layout horizontal flex wrap">
      <paper-button class="flex-2" on-tap="incrementScore" raised runs="1" extras="true">Wide Only</paper-button>
      <paper-button class="flex-2" raised>Wide + Runs</paper-button>
      <paper-button class="flex-2" raised>Wide + Run out</paper-button>
      <paper-button class="flex-2" raised>Wide + Wicket </paper-button>
    </div>
    <div class="layout horizontal flex wrap">
      <paper-button class="flex-2" raised>No ball Only</paper-button>
      <paper-button class="flex-2" raised>No ball + Runs</paper-button>
      <paper-button class="flex-2" raised>No ball + Run out</paper-button>
      <paper-button class="flex-2" raised>No ball + Wicket </paper-button>
    </div>
    <div class="layout horizontal flex wrap">
      <paper-button class="flex-2" raised on-tap="incrementWickets">Bowled</paper-button>
      <paper-button class="flex-2" raised on-tap="incrementWickets">Caught</paper-button>
      <paper-button class="flex-2" raised on-tap="incrementWickets">Stumped</paper-button>
      <paper-button class="flex-2" raised on-tap="incrementWickets">Run out</paper-button>
      <paper-button class="flex-2" raised on-tap="incrementWickets">LBW</paper-button>
      <paper-button class="flex-2" raised on-tap="incrementWickets">Hit Wkt</paper-button>
      <!--<paper-button class="flex-2 btn-inverse" disabled>Other</paper-button>-->
    </div>
    <paper-toast id="toast" text="Innings completed!!"></paper-toast>
  </template>

  <script>
    Polymer({

      is: 'input-score',

      properties: {
        score: {
            type: Object,
            value: function () { return {}; }
        }
      },
      incrementScore: function(e) {
        console.log('target',e.target.hasAttribute('extras'));
        var increment = parseInt(e.target.getAttribute('runs'));
        this.$.fireQuery.setStoredValue('/team/fixtures/0/score/runs', parseInt(this.score.runs) + increment);

        if(!e.target.hasAttribute('extras')) {
          this.incrementBalls();
        }

        console.log('target is', parseInt(this.score.target));

        if(parseInt(this.score.target) >= 0 && (parseInt(this.score.runs) > parseInt(this.score.target))) {
          this.$.toast.text = "Target successfully chased";
          this.$.toast.open();
        }
      },
      incrementBalls: function() {
        var balls = parseInt(this.score.balls)+1;
        if(balls == 6) {
          balls = 0;
          this.incrementOvers();
        }
        this.$.fireQuery.setStoredValue('/team/fixtures/0/score/balls', balls);
      },
      incrementOvers: function() {
        this.$.fireQuery.setStoredValue('/team/fixtures/0/score/overs', parseInt(this.score.overs) +1);
      },
      incrementWickets: function() {
        var wickets = parseInt(this.score.wickets) +1;
        if(this.score.target == 0 && wickets == 10) {
          this.score.target = this.score.runs;
          this.$.fireQuery.setStoredValue('/team/fixtures/0/score/target', this.score.target);
          this.$.fireQuery.setStoredValue('/team/fixtures/0/score/runs', 0);
          this.$.fireQuery.setStoredValue('/team/fixtures/0/score/overs', 0);
          this.$.fireQuery.setStoredValue('/team/fixtures/0/score/balls', 0);
          wickets = 0;
          this.$.toast.open();
        }
        this.$.fireQuery.setStoredValue('/team/fixtures/0/score/wickets', wickets);
      }
    });
  </script>
</dom-module>
